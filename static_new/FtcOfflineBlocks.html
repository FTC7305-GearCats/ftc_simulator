<!DOCTYPE html>
<html>
<!--
  Author: lizlooney@google.com (Liz Looney)
-->
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">

  <link rel="stylesheet" type="text/css" href="blocks/images.css">
  <link rel="stylesheet" type="text/css" href="css/blocks_offline.css">
  <link rel="stylesheet" type="text/css" href="css/blocks_common_less.css">
  <link rel="stylesheet" type="text/css" href="css/blocks_common.css">

  <script type="text/javascript" src="js/split.min.js"></script>
  <script type="text/javascript" src="blockly/blockly_compressed.js"></script>
  <script type="text/javascript" src="blockly/msg/messages.js"></script>
  <script type="text/javascript" src="blockly/blocks_compressed.js"></script>
  <script type="text/javascript" src="blockly/javascript_compressed.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava/lists.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava/logic.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava/loops.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava/math.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava/procedures.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava/text.js"></script>
  <script type="text/javascript" src="ftcblockly/generators/ftcjava/variables.js"></script>

  <script type="text/javascript" src="js/FtcOfflineBlocks.js"></script>
  <script type="text/javascript" src="blocks/FtcBlocks_common.js"></script>
  <script type="text/javascript" src="js/acorn.js"></script>
  <script type="text/javascript" src="js/interpreter.js"></script>
  <script type="text/javascript" src="js/simulator.js"></script>

  <script type="text/javascript" src="blocks/acceleration.js"></script>
  <script type="text/javascript" src="blocks/acceleration_sensor.js"></script>
  <script type="text/javascript" src="blocks/analog_input.js"></script>
  <script type="text/javascript" src="blocks/analog_output.js"></script>
  <script type="text/javascript" src="blocks/android_accelerometer.js"></script>
  <script type="text/javascript" src="blocks/android_gyroscope.js"></script>
  <script type="text/javascript" src="blocks/android_orientation.js"></script>
  <script type="text/javascript" src="blocks/android_sound_pool.js"></script>
  <script type="text/javascript" src="blocks/android_text_to_speech.js"></script>
  <script type="text/javascript" src="blocks/angular_velocity.js"></script>
  <script type="text/javascript" src="blocks/bno055imu.js"></script>
  <script type="text/javascript" src="blocks/bno055imu_parameters.js"></script>
  <script type="text/javascript" src="blocks/clipboard_util.js"></script>
  <script type="text/javascript" src="blocks/color.js"></script>
  <script type="text/javascript" src="blocks/color_range_sensor.js"></script>
  <script type="text/javascript" src="blocks/color_sensor.js"></script>
  <script type="text/javascript" src="blocks/compass_sensor.js"></script>
  <script type="text/javascript" src="blocks/cr_servo.js"></script>
  <script type="text/javascript" src="blocks/dbg_log.js"></script>
  <script type="text/javascript" src="blocks/dc_motor.js"></script>
  <script type="text/javascript" src="blocks/digital_channel.js"></script>
  <script type="text/javascript" src="blocks/distance_sensor.js"></script>
  <script type="text/javascript" src="blocks/elapsed_time.js"></script>
  <script type="text/javascript" src="blocks/elapsed_time2.js"></script>
  <script type="text/javascript" src="blocks/gamepad.js"></script>
  <script type="text/javascript" src="blocks/gyro_sensor.js"></script>
  <script type="text/javascript" src="blocks/hardware_util.js"></script>
  <script type="text/javascript" src="blocks/ir_seeker_sensor.js"></script>
  <script type="text/javascript" src="blocks/led.js"></script>
  <script type="text/javascript" src="blocks/light_sensor.js"></script>
  <script type="text/javascript" src="blocks/linear_op_mode.js"></script>
  <script type="text/javascript" src="blocks/locale.js"></script>
  <script type="text/javascript" src="blocks/magnetic_flux.js"></script>
  <script type="text/javascript" src="blocks/matrix_f.js"></script>
  <script type="text/javascript" src="blocks/misc.js"></script>
  <script type="text/javascript" src="blocks/mr_i2c_compass_sensor.js"></script>
  <script type="text/javascript" src="blocks/mr_i2c_range_sensor.js"></script>
  <script type="text/javascript" src="blocks/navigation.js"></script>
  <script type="text/javascript" src="blocks/open_gl_matrix.js"></script>
  <script type="text/javascript" src="blocks/optical_distance_sensor.js"></script>
  <script type="text/javascript" src="blocks/orientation.js"></script>
  <script type="text/javascript" src="blocks/pidf_coefficients.js"></script>
  <script type="text/javascript" src="blocks/position.js"></script>
  <script type="text/javascript" src="blocks/project_util.js"></script>
  <script type="text/javascript" src="blocks/quaternion.js"></script>
  <script type="text/javascript" src="blocks/range.js"></script>
  <script type="text/javascript" src="blocks/rev_blinkin_led_driver.js"></script>
  <script type="text/javascript" src="blocks/rumble_effect.js"></script>
  <script type="text/javascript" src="blocks/servo.js"></script>
  <script type="text/javascript" src="blocks/servo_controller.js"></script>
  <!-- sound_util.js is not needed -->
  <script type="text/javascript" src="blocks/system.js"></script>
  <script type="text/javascript" src="blocks/telemetry.js"></script>
  <script type="text/javascript" src="blocks/temperature.js"></script>
  <script type="text/javascript" src="blocks/tfod.js"></script>
  <script type="text/javascript" src="blocks/tfod_current_game.js"></script>
  <script type="text/javascript" src="blocks/tfod_custom_model.js"></script>
  <script type="text/javascript" src="blocks/tfod_recognition.js"></script>
  <script type="text/javascript" src="blocks/tfod_rover_ruckus.js"></script>
  <script type="text/javascript" src="blocks/tfod_sky_stone.js"></script>
  <script type="text/javascript" src="blocks/toolbox_util.js"></script>
  <script type="text/javascript" src="blocks/touch_sensor.js"></script>
  <script type="text/javascript" src="blocks/ultrasonic_sensor.js"></script>
  <script type="text/javascript" src="blocks/vars.js"></script>
  <script type="text/javascript" src="blocks/vector_f.js"></script>
  <script type="text/javascript" src="blocks/velocity.js"></script>
  <script type="text/javascript" src="blocks/voltage_sensor.js"></script>
  <script type="text/javascript" src="blocks/vuforia.js"></script>
  <script type="text/javascript" src="blocks/vuforia_current_game.js"></script>
  <script type="text/javascript" src="blocks/vuforia_localizer.js"></script>
  <script type="text/javascript" src="blocks/vuforia_localizer_parameters.js"></script>
  <script type="text/javascript" src="blocks/vuforia_relic_recovery.js"></script>
  <script type="text/javascript" src="blocks/vuforia_rover_ruckus.js"></script>
  <script type="text/javascript" src="blocks/vuforia_sky_stone.js"></script>
  <script type="text/javascript" src="blocks/vuforia_trackable.js"></script>
  <script type="text/javascript" src="blocks/vuforia_trackable_default_listener.js"></script>
  <script type="text/javascript" src="blocks/vuforia_trackables.js"></script>

  <title>FTC</title>
</head>
<body onload="initializeFtcBlocks()">
<div class="vertical_area" style="height:100%; padding: 0;">
  <table class="top" width="100%">
    <tr>
      <td class="blank_td" colspan="2"></td>
    </tr>
    <tr>
      <td class="buttons_td" colspan="2">
        <table width="100%"><tr><td>
          <button onclick="saveButtonClicked()">Save Op Mode</button>
          <button onclick="exportJavaButtonClicked()">Download Java</button>
          <button onclick="downloadButtonClicked()">Download Op Mode</button>
          <button id="downloadImageButton" style="display: none" disabled="true"
                  onclick="downloadImageButtonClicked()">Download Image of Blocks</button>
          <a id="download_link"></a>
          <span id="saveSuccess" style="display: none">Save completed successfully.</span>
          <span id="saveFailure" style="display: none"></span>
        </td></tr></table>
      </td>
    </tr>
    <tr>
      <td class="blank_td" colspan="2"></td>
    </tr>
    <tr class="project_row_tr">
      <td class="project_row_td">
        Op Mode Name:&nbsp;<span id="project_name" class="not_bold"></span>
        &nbsp;
        <select id="project_flavor" class="not_bold" onchange="projectFlavorChanged()">
          <option value="TELEOP">TeleOp</option>
          <option value="AUTONOMOUS">Autonomous</option>
        </select>
        &nbsp;
        Group:&nbsp;<input type="text" id="project_group" class="not_bold" oninput="projectGroupChanged()">
        &nbsp;
        <input type="checkbox" id="project_enabled" class="project_row_checkbox" onclick="projectEnabledChanged()">&nbsp;Enabled
        &nbsp;
        &nbsp;
        <span id="project_autoTransition_label" style="display: none;">Preselect TeleOp:</span>
        <select id="project_autoTransition" class="not_bold" style="width: 150px; display: none;" onchange="projectAutoTransitionChanged()">
        </select>
      </td>
      <td align="right">
        <input type="checkbox" id="show_java" class="project_row_checkbox" onclick="showJavaChanged()">&nbsp;Show Java&nbsp;&nbsp;
        <input type="checkbox" id="show_simulator" class="project_row_checkbox" onclick="showJavaChanged()">&nbsp;Show Sim&nbsp;&nbsp;
      </td>
    </tr>
  </table>

  <div id="parentArea" class="parent_area horizontal_area fill_area no_min_height" style="visibility: hidden;">
    <div id="blocksAndBannerArea" class="vertical_area">
      <div id="banner" class="banner" style="display: none;">
        <span id="bannerText" class="banner_text"></span>
        <button id="bannerBtn" class="btn btn-default btn-xs" type="button">Button</button>
      </div>
      <div id='blocklyArea' class="fill_area"></div>
    </div>
    <div class="dragBar" id="dragBar" draggable="true"></div>
    <div id="javaArea" class="vertical_area no_min_width">
      <div id="javaCodeHeading">Java Code:</div>
      <div id="javaContentContainer" class="fill_area content_border">
        <pre id="javaContent"></pre>
      </div>
    </div>
    <div class="dragBar" id="dragBar2" draggable="true"></div>
    <div id="simulatorArea" class="vertical_area no_min_width">
      <div>
        <button onclick="runSimulator()">Run Simulator</button>
        <button onclick="stopSimulator()">Stop Simulator</button>
        <a href="/keyboard.html">Keyboard</a>
      </div>
      <svg id="world" width="500px" height="500px"
           viewbox="-400 -400 500 500"
           style="border: 0.5rem solid">
        <defs>
          <pattern id="grid" width="60.96" height="60.96"
                   patternUnits="userSpaceOnUse">
            <path d="M 0 0 h 60.96 v 60.96 h -60.96 z"
                  fill="gray" stroke="black" stroke-width="1"/>
          </pattern>
          <symbol id="wheel">
            <rect x="0" y="0" width="5" height="10" fill="#e3c500"
                  stroke="black" stroke-width="0.45"/>
          </symbol>
          <symbol id="robot_diagram">
            <!-- Center is 21.77, 20.95 -->
            <use id="frwheel" xlink:href="#wheel" x="0" y="28.09"/>
            <use id="flwheel" xlink:href="#wheel" x="38.54" y="28.09"/>
            <use id="brwheel" xlink:href="#wheel" x="0" y="0"/>
            <use id="blwheel" xlink:href="#wheel" x="38.54" y="0"/>
            <rect x="5.72" y="0" width="32.1" height="41.9" fill="#BBB"/>
            <rect x=".98" y="38.73" width="41.59" height="3.17" fill="#BBB"/>
            <path d="M 6.72 20.95 L 21.77 30.95 L 36.82 20.95 L 6.72 20.95"
          </symbol>
        </defs>
        <rect id="world_grid" fill="transparent" />
        <!-- 2021 - Freight Frenzy field -->
        <!-- Outline -->
        <path d="M 0 0 V -365.76 H -365.76 V 0 Z"
              fill="url(#grid)" stroke="black" />
        <!-- Red Storage Unit -->
        <path d="M -62.825 0 v -55.88 h -55.88 v 55.88"
              fill="transparent" stroke="red" stroke-width="5.08" />
        <!-- Blue Storage Unit -->
        <path d="M -302.925 0 v -55.88 h 55.88 v 55.88"
              fill="transparent" stroke="blue" stroke-width="5.08" />
        <!-- Red Warehouse -->
        <path d="M 0 -257.81 h -110.49 v -110.49"
              fill="transparent" stroke="white" stroke-width="5.08" />
        <!-- Blue Warehouse -->
        <path d="M -365.76 -257.81 h 110.49 v -110.49"
              fill="transparent" stroke="white" stroke-width="5.08" />
        <!-- Barrier -->
        <path d="M -34.798 -249.555 L -330.962 -249.555
                 M -34.798 -238.125 L -330.962 -238.125
                 M -116.205 -249.555 L -116.205 -330.835
                 M -127.635 -249.555 L -127.635 -330.835
                 M -249.555 -249.555 L -249.555 -330.835
                 M -238.125 -249.555 L -238.125 -330.835"
              fill="transparent" stroke="black" stroke-width="2.6924" />
        <!-- Red Carousel -->
        <circle cx="-5.08" cy="-5.08" r="19.05" fill="#800" />
        <!-- Blue Carousel -->
        <circle cx="-360.68" cy="-5.08" r="19.05" fill="#008" />
        <!-- Red Shipping Hub -->
        <circle cx="-121.92" cy="-152.4" r="22.86" fill="#800" />
        <!-- Blue Shipping Hub -->
        <circle cx="-243.84" cy="-152.4" r="22.86" fill="#008" />
        <!-- Shared Shipping Hub -->
        <circle cx="-182.88" cy="-304.8" r="22.86" fill="#000" />
        <!-- Red barcodes -->
        <path d="M -86.995 -65.405 h -5.08 v -5.08 h 5.08 z
                 M -86.995 -86.6902 h -5.08 v -5.08 h 5.08 z
                 M -86.995 -107.9754 h -5.08 v -5.08 h 5.08 z
                 M -86.995 -185.42 h -5.08 v -5.08 h 5.08 z
                 M -86.995 -206.7052 h -5.08 v -5.08 h 5.08 z
                 M -86.995 -227.9904 h -5.08 v -5.08 h 5.08 z"
              fill="red" stroke="transparent" />
        <!-- Blue barcodes -->
        <path d="M -278.765 -65.405 h -5.08 v -5.08 h 5.08 z
                 M -278.765 -86.6902 h -5.08 v -5.08 h 5.08 z
                 M -278.765 -107.9754 h -5.08 v -5.08 h 5.08 z
                 M -278.765 -185.42 h -5.08 v -5.08 h 5.08 z
                 M -278.765 -206.7052 h -5.08 v -5.08 h 5.08 z
                 M -278.765 -227.9904 h -5.08 v -5.08 h 5.08 z"
              fill="blue" stroke="transparent" />
        <!-- End Freight Frenzy field -->
        <!-- Reference lines for drawing
             <line x1="-50" y1="0" x2="50" y2="0" stroke="red" />
             <line x1="0" y1="-50" x2="0" y2="50" stroke="red" />
        -->
        <path id="robot_trail" fill="none" stroke="red" />
        <use id="robot"
             xlink:href="#robot_diagram"
             x="22" y="91.4"
             transform="rotate(180) translate(-21.77 -20.95)" />
      </svg>
      <svg id="motors" width="500px" height="100px"
           viewbox="0 0 500 100"
           style="border: 0.1rem solid">
        <defs>
          <symbol id="servo">
            <polygon stroke="black" points="15, 10 45, 10 30, 50"
                     fill="transparent" stroke-width="3" />
          </symbol>
        </defs>
        <use id="servo1"
             xlink:href="#servo"
             x="10" y="10"
             transform="rotate(0, 40, 30)" />
        <text x="20" y="80">Servo1</text>
        <use id="servo2"
             xlink:href="#servo"
             x="70" y="10"
             transform="rotate(0, 100, 30)" />
        <text x="80" y="80">Servo2</text>
      </svg>
    </div>
  </div>

  <div id="blocklyDiv" class="content_border" style="position: absolute;"></div>

  <xml id="toolbox" style="display: none">
    <category name="Miscellaneous">
    </category>
  </xml>

  <div id="saveWithWarningsDialog" class="modal_dialog"><div class="modal_dialog_container"><div class="modal_dialog_content">
    <center>
      <h3 style="margin-top: 0px">Save Op Mode</h3><br>
      <div id="saveWithWarningsMessage"></div><br>
      Are you sure you want to save now?<br><br>
      <table width="100%">
        <tr>
          <td align="center"><button onclick="noSaveWithWarningsDialog()">No</button></td>
          <td align="center"><button onclick="yesSaveWithWarningsDialog()">Yes</button></td>
        </tr>
      </table>
    </center>
  </div></div></div>
</div>

<script type="text/javascript">

  function exportJavaButtonClicked() {
    var javaCode = generateJavaCode();
    if (javaCode) {
      // Download the java file.
      var a = document.getElementById('download_link');
      a.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(javaCode);
      a.download = currentClassName + '.java';
      a.target = '_blank';
      a.click();
    } else {
      alert('Unable to download Java. Sorry about that!');
    }
  }

</script>
</body>
</html>
